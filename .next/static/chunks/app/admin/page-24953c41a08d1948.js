(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{4862:(e,s,a)=>{Promise.resolve().then(a.bind(a,7929))},7929:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var t=a(5155),l=a(2115),r=a(8173),i=a.n(r),n=a(5055),d=a(3312),c=a(7936),o=a(2472),m=a(9962),x=a(3474),h=a(1354),u=a(8810),f=a(5524),g=a(9949),p=a(7058),b=a(6472),j=a(5781),v=a(3900),y=a(8986),N=a(399);function w(){let[e,s]=(0,l.useState)(!1),[a,r]=(0,l.useState)([]),[j,w]=(0,l.useState)(!0),[k,C]=(0,l.useState)(null),[S,E]=(0,l.useState)(!1),[A,z]=(0,l.useState)(null),[U,P]=(0,l.useState)(null),[$,_]=(0,l.useState)(!1),[I,B]=(0,l.useState)(null),[D,F]=(0,l.useState)(null),[G,J]=(0,l.useState)(""),[R,T]=(0,l.useState)(0);(0,l.useEffect)(()=>{(async()=>{w(!0);try{let e=(await (0,p.GG)((0,p.rJ)(g.db,"users"))).docs.map(e=>{let s=e.data();return{id:e.id,name:s.name||"",email:s.email||"",avatar:s.avatar||"",avatarSrc:s.avatar||""}});r(e);let s=await (0,p.GG)((0,p.rJ)(g.db,"donated-food"));T(s.size)}catch(e){console.error("Error fetching users:",e)}finally{w(!1)}})()},[]),(0,l.useEffect)(()=>{let e=(0,N.xI)(),s=(0,N.hg)(e,async e=>{if(e){let s=(await (0,p.GG)((0,p.rJ)(g.db,"users"))).docs.find(s=>s.id===e.uid);s&&s.data().avatar?J(s.data().avatar):J("")}else J(""),window.location.href="/login"});return()=>s()},[g.db,N.xI,N.hg]);let O=e=>{C(a.find(s=>s.id===e)||null),z(null),F(null)},q=e=>{if(!k)return;let{name:s,value:a}=e.target;C({...k,[s]:a})},K=async()=>{if(k){E(!0),z(null),F(null);try{let e=await fetch("/api/users",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:k.id,name:k.name,email:k.email})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to update user");r(e=>e.map(e=>e.id===k.id?{...e,name:k.name,email:k.email}:e)),F("User updated successfully."),C(null)}catch(e){e instanceof Error?z(e.message):z("Unknown error")}finally{E(!1)}}},W=e=>{P(a.find(s=>s.id===e)||null),B(null),F(null)},H=async()=>{if(U){_(!0),B(null),F(null);try{let e=(0,N.xI)().currentUser;if(!e)throw Error("Not signed in");let s=await e.getIdToken(),a=await fetch("/api/users",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({id:U.id})}),t=await a.json();if(!a.ok)throw Error(t.error||"Failed to delete user");r(e=>e.filter(e=>e.id!==U.id)),F("User deleted successfully."),P(null)}catch(e){e instanceof Error?B(e.message):B("Unknown error")}finally{_(!1)}}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100 flex",children:[(0,t.jsx)("div",{className:"fixed top-0 left-0 w-full z-20 bg-white shadow flex flex-col items-center py-4 lg:ml-64",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 w-full max-w-4xl justify-center items-center",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center bg-green-50 rounded-lg px-6 py-4 shadow",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-green-700",children:a.length}),(0,t.jsx)("span",{className:"text-gray-600",children:"Total Users"})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center bg-blue-50 rounded-lg px-6 py-4 shadow",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-blue-700",children:R}),(0,t.jsx)("span",{className:"text-gray-600",children:"Total Posts"})]}),(0,t.jsx)("div",{className:"w-72 h-48 bg-white rounded-lg shadow flex items-center justify-center",children:(0,t.jsx)(b.yP,{data:{labels:["Users","Posts"],datasets:[{label:"Count",data:[a.length,R],backgroundColor:["#22c55e","#3b82f6"]}]},options:{responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Users vs Posts"}},scales:{y:{beginAtZero:!0}}}})})]})}),(0,t.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,t.jsx)(d.$,{variant:"outline",size:"icon",onClick:()=>s(!e),className:"bg-white",children:(0,t.jsx)(c.A,{className:"h-5 w-5"})})}),(0,t.jsx)("div",{className:"\n        fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        ".concat(e?"translate-x-0":"-translate-x-full"," lg:translate-x-0\n      "),children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"p-6 border-b",children:(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-600",children:"FWRP"})}),(0,t.jsxs)("div",{className:"flex-1 py-6 px-4 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsxs)(n.eu,{className:"h-20 w-20",children:[(0,t.jsx)(n.BK,{src:G||"/placeholder.svg?height=80&width=80",alt:"Admin"}),(0,t.jsx)(n.q5,{children:(0,t.jsx)(o.A,{className:"h-10 w-10"})})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Admin User"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"admin@fwrp.com"})]})]}),(0,t.jsxs)("nav",{className:"mt-8 space-y-2",children:[(0,t.jsxs)(i(),{href:"/admin",className:"flex items-center p-3 bg-gray-100 text-green-600 rounded-md",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 mr-3"}),"Admin Dashboard"]}),(0,t.jsxs)(i(),{href:"/edit-profile",className:"flex items-center p-3 text-gray-700 rounded-md hover:bg-gray-100",children:[(0,t.jsx)(x.A,{className:"h-5 w-5 mr-3"}),"Edit Profile"]})]})]}),(0,t.jsx)("div",{className:"p-4 border-t",children:(0,t.jsxs)(d.$,{variant:"outline",className:"w-full justify-start",onClick:async()=>{try{let e=(0,N.xI)();await e.signOut(),window.location.href="/login"}catch(e){alert("Failed to sign out. Please try again.")}},children:[(0,t.jsx)(h.A,{className:"h-5 w-5 mr-3"}),"Sign out"]})})]})}),(0,t.jsxs)("div",{className:"flex-1 lg:ml-64 pt-40",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:j?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsxs)("svg",{className:"animate-spin h-8 w-8 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]})}):(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-6 border-b",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"User Management"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1",children:"View and manage all users in the system"})]}),D&&(0,t.jsx)("div",{className:"p-4 text-green-700 bg-green-100 border border-green-300 mb-2 rounded",children:D}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,t.jsxs)(n.eu,{children:[(0,t.jsx)(n.BK,{src:e.avatarSrc||"/placeholder.svg",alt:e.name}),(0,t.jsx)(n.q5,{children:e.name[0].toUpperCase()})]})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>O(e.id),children:(0,t.jsx)(u.A,{className:"h-4 w-4"})}),(0,t.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>W(e.id),children:(0,t.jsx)(f.A,{className:"h-4 w-4 text-red-500"})})]})})]},e.id))})]})}),(0,t.jsx)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:(0,t.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,t.jsx)("span",{className:"font-medium",children:"1"})," to"," ",(0,t.jsx)("span",{className:"font-medium",children:a.length})," of"," ",(0,t.jsx)("span",{className:"font-medium",children:a.length})," results"]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,t.jsx)(d.$,{variant:"outline",className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),(0,t.jsx)(d.$,{variant:"outline",className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:"1"}),(0,t.jsx)(d.$,{variant:"outline",className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"})]})})]})})]})})]}),k&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Edit User"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(y.J,{htmlFor:"edit-name",children:"Name"}),(0,t.jsx)(v.p,{id:"edit-name",name:"name",value:k.name||"",onChange:q})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.J,{htmlFor:"edit-email",children:"Email"}),(0,t.jsx)(v.p,{id:"edit-email",name:"email",value:k.email||"",onChange:q})]}),A&&(0,t.jsx)("div",{className:"text-red-600",children:A})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,t.jsx)(d.$,{variant:"outline",onClick:()=>C(null),disabled:S,children:"Cancel"}),(0,t.jsx)(d.$,{onClick:K,disabled:S,children:S?"Saving...":"Save"})]})]})}),U&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Delete User"}),(0,t.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,t.jsx)("span",{className:"font-bold",children:U.name}),"? This action cannot be undone."]}),I&&(0,t.jsx)("div",{className:"text-red-600 mt-2",children:I}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,t.jsx)(d.$,{variant:"outline",onClick:()=>P(null),disabled:$,children:"Cancel"}),(0,t.jsx)(d.$,{variant:"destructive",onClick:H,disabled:$,children:$?"Deleting...":"Delete"})]})]})}),e&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>s(!1)})]})}j.t1.register(j.PP,j.kc,j.E8,j.hE,j.m_,j.s$)},9949:(e,s,a)=>{"use strict";a.d(s,{db:()=>d,j:()=>n});var t=a(9904),l=a(399),r=a(7058);let i=(0,t.Wp)({apiKey:"AIzaSyB6LYkEpOGtaAsEr3biosqd_QC3YSud9cw",authDomain:"fwrp-11fc3.firebaseapp.com",projectId:"fwrp-11fc3",storageBucket:"fwrp-11fc3.firebasestorage.app",messagingSenderId:"707085459051",appId:"1:707085459051:web:94dfad19e1e5b22b479b2e",measurementId:"G-K083R1WZWC"}),n=(0,l.xI)(i),d=(0,r.aU)(i)},5055:(e,s,a)=>{"use strict";a.d(s,{BK:()=>d,eu:()=>n,q5:()=>c});var t=a(5155),l=a(2115),r=a(2219),i=a(1567);let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...l})});n.displayName=r.bL.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",a),...l})});d.displayName=r._V.displayName;let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...l})});c.displayName=r.H4.displayName},3312:(e,s,a)=>{"use strict";a.d(s,{$:()=>c});var t=a(5155),l=a(2115),r=a(1290),i=a(1027),n=a(1567);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,s)=>{let{className:a,variant:l,size:i,asChild:c=!1,...o}=e,m=c?r.DX:"button";return(0,t.jsx)(m,{className:(0,n.cn)(d({variant:l,size:i,className:a})),ref:s,...o})});c.displayName="Button"},3900:(e,s,a)=>{"use strict";a.d(s,{p:()=>i});var t=a(5155),l=a(2115),r=a(1567);let i=l.forwardRef((e,s)=>{let{className:a,type:l,...i}=e;return(0,t.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...i})});i.displayName="Input"},8986:(e,s,a)=>{"use strict";a.d(s,{J:()=>c});var t=a(5155),l=a(2115),r=a(6195),i=a(1027),n=a(1567);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.b,{ref:s,className:(0,n.cn)(d(),a),...l})});c.displayName=r.b.displayName},1567:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(3463),l=a(9795);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,l.QP)((0,t.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,446,647,173,344,302,441,517,358],()=>s(4862)),_N_E=e.O()}]);