(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{6393:(e,a,s)=>{Promise.resolve().then(s.bind(s,4751))},4751:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>b});var l=s(5155),t=s(5055),r=s(3312),i=s(2115),n=s(1567);let d=i.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t})});d.displayName="Card";let c=i.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...t})});c.displayName="CardHeader";let o=i.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",s),...t})});o.displayName="CardContent";var m=s(7936),x=s(2472),h=s(3474),f=s(7493),u=s(7433),N=s(1354);let j=(0,s(4057).A)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var p=s(8173),g=s.n(p),v=s(9949),w=s(399),y=s(7536);function b(){let[e,a]=(0,i.useState)(!1),[s,n]=(0,i.useState)({displayName:null,email:null,avatar:null}),[p,b]=(0,i.useState)({fullName:"",email:"",avatar:""}),[k,C]=(0,i.useState)([]),[I,A]=(0,i.useState)({}),[E,S]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{let e=(0,w.hg)(v.j,async e=>{if(e){let a=await (0,y.V)(e);n(a),b({fullName:a.fullName||a.displayName,email:a.email,avatar:a.avatar})}else window.location.href="/login"});return()=>e()},[]),(0,i.useEffect)(()=>{(async function(){S(!0);try{let e=await (0,y.w)();C(e.donations||[]);let a=(e.donations||[]).map(e=>e.userId).filter(Boolean),s=Array.from(new Set(a)),l={};await Promise.all(s.map(async e=>{try{let a=await fetch("/api/users/".concat(e));if(a.ok){let s=await a.json();s.phone&&(l[e]=s.phone)}}catch(e){}})),A(l)}catch(e){C([]),A({})}finally{S(!1)}})()},[]),E||!p.fullName)?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,l.jsx)("div",{className:"text-center text-gray-500 text-lg",children:"Loading dashboard..."})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100 flex",children:[(0,l.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,l.jsx)(r.$,{variant:"outline",size:"icon",onClick:()=>a(!e),className:"bg-white",children:(0,l.jsx)(m.A,{className:"h-5 w-5"})})}),(0,l.jsx)("div",{className:"\n        fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        ".concat(e?"translate-x-0":"-translate-x-full"," lg:translate-x-0\n      "),children:(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsx)("div",{className:"p-6 border-b",children:(0,l.jsx)("h2",{className:"text-2xl font-bold text-green-600",children:"FWRP"})}),(0,l.jsxs)("div",{className:"flex-1 py-6 px-4 space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,l.jsxs)(t.eu,{className:"h-20 w-20",children:[(0,l.jsx)(t.BK,{src:p.avatar||"/placeholder.svg?height=80&width=80",alt:"Profile"}),(0,l.jsx)(t.q5,{children:(0,l.jsx)(x.A,{className:"h-10 w-10"})})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h3",{className:"font-medium",children:p.fullName}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:p.email})]})]}),(0,l.jsxs)("nav",{className:"mt-8 space-y-2",children:[(0,l.jsxs)(g(),{href:"/edit-profile",className:"flex items-center p-3 text-gray-700 rounded-md hover:bg-gray-100",children:[(0,l.jsx)(h.A,{className:"h-5 w-5 mr-3"}),"Show Profile"]}),(0,l.jsxs)(g(),{href:"/dashboard",className:"flex items-center p-3 bg-gray-100 text-green-600 rounded-md",children:[(0,l.jsx)(f.A,{className:"h-5 w-5 mr-3"}),"Dashboard"]}),(0,l.jsxs)(g(),{href:"/donate-food",className:"flex items-center p-3 text-gray-700 rounded-md hover:bg-gray-100",children:[(0,l.jsx)(u.A,{className:"h-5 w-5 mr-3"}),"Donate Food"]})]})]}),(0,l.jsx)("div",{className:"p-4 border-t",children:(0,l.jsxs)(r.$,{variant:"outline",className:"w-full justify-start",onClick:async()=>{try{await v.j.signOut(),window.location.href="/login"}catch(e){alert("Failed to sign out. Please try again.")}},children:[(0,l.jsx)(N.A,{className:"h-5 w-5 mr-3"}),"Sign out"]})})]})}),(0,l.jsxs)("div",{className:"flex-1 lg:ml-64",children:[(0,l.jsx)("header",{className:"bg-white shadow",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"})})}),(0,l.jsx)("main",{className:"max-w-2xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,l.jsx)("div",{className:"space-y-6",children:E?(0,l.jsx)("div",{className:"text-center text-gray-500",children:"Loading donated food..."}):0===k.length?(0,l.jsx)("div",{className:"text-center text-gray-500",children:"No food has been donated yet."}):k.map(e=>{var a,i,n;return(0,l.jsxs)(d,{className:"overflow-hidden",children:[(0,l.jsxs)(c,{className:"p-4 flex items-center space-x-4",children:[(0,l.jsxs)(t.eu,{children:[(0,l.jsx)(t.BK,{src:e.avatar||"/placeholder.svg?height=80&width=80",alt:e.foodName||"Donator"}),(0,l.jsx)(t.q5,{children:e.foodName?e.foodName[0].toUpperCase():"?"})]}),(0,l.jsx)("span",{className:"font-semibold flex-1 text-center",children:e.foodName})]}),(0,l.jsxs)(o,{className:"p-0",children:[(0,l.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:"Food",className:"w-full h-auto"}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),e.userId&&I[e.userId]&&(0,l.jsxs)("div",{className:"text-sm text-gray-700 mb-2",children:[(0,l.jsx)("span",{className:"font-semibold text-green-700",children:"Phone:"})," ",I[e.userId]]}),(0,l.jsxs)("p",{className:"text-gray-500 text-sm mb-2",children:[(0,l.jsx)("span",{className:"font-semibold text-green-700",children:"Location:"})," ",e.location]}),(0,l.jsxs)("p",{className:"text-gray-500 text-sm mb-2",children:[(0,l.jsx)("span",{className:"font-semibold text-green-700",children:"Expiry:"})," ",e.expiryDate||"N/A"]}),(0,l.jsxs)("p",{className:"text-gray-500 text-sm mb-4",children:[(0,l.jsx)("span",{className:"font-semibold text-green-700",children:"Pickup:"})," ",e.pickupInstructions||"N/A"]}),(0,l.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,l.jsxs)("div",{className:"flex justify-center",children:[e.userId!==(null==s?void 0:s.email)&&e.userId!==(null===(a=v.j.currentUser)||void 0===a?void 0:a.uid)&&(0,l.jsxs)(r.$,{className:"w-full sm:w-auto",onClick:async()=>{var a;let s=e.userId?null===(a=I[e.userId])||void 0===a?void 0:a.replace(/[^\d+]/g,""):"";if(!s){alert("No phone number available for this donor.");return}window.open("https://wa.me/".concat(s),"_blank")},children:[(0,l.jsx)(j,{className:"h-5 w-5 mr-2"}),"Contact Donator"]}),e.userId===(null==s?void 0:s.email)||e.userId===(null===(i=v.j.currentUser)||void 0===i?void 0:i.uid)?(0,l.jsx)(r.$,{className:"w-full sm:w-auto ml-2 bg-blue-500 hover:bg-blue-600",onClick:()=>{window.location.href="/edit-donation/".concat(e.id)},children:"Edit"}):null,e.userId===(null==s?void 0:s.email)||e.userId===(null===(n=v.j.currentUser)||void 0===n?void 0:n.uid)?(0,l.jsx)(r.$,{className:"w-full sm:w-auto ml-2 bg-red-500 hover:bg-red-600",onClick:async()=>{if(confirm("Are you sure you want to delete this donation?"))try{if(!(await fetch("/api/donated-food?id=".concat(e.id),{method:"DELETE"})).ok)throw Error("Failed to delete");C(a=>a.filter(a=>a.id!==e.id))}catch(e){alert("Error deleting donation")}},children:"Delete"}):null]})})]})]})]},e.id)})})})]}),e&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>a(!1)})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,446,173,344,604,441,517,358],()=>a(6393)),_N_E=e.O()}]);