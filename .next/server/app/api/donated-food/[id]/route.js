(()=>{var e={};e.id=476,e.ids=[476],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},33873:e=>{"use strict";e.exports=require("path")},11723:e=>{"use strict";e.exports=require("querystring")},27910:e=>{"use strict";e.exports=require("stream")},79551:e=>{"use strict";e.exports=require("url")},9801:e=>{"use strict";e.exports=import("firebase-admin/app")},7879:e=>{"use strict";e.exports=import("firebase-admin/firestore")},12916:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{patchFetch:()=>p,routeModule:()=>c,serverHooks:()=>f,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var o=t(42706),a=t(28203),i=t(45994),n=t(13765),u=e([n]);n=(u.then?(await u)():u)[0];let c=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/donated-food/[id]/route",pathname:"/api/donated-food/[id]",filename:"route",bundlePath:"app/api/donated-food/[id]/route"},resolvedPagePath:"D:\\FWRP\\src\\app\\api\\donated-food\\[id]\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:f}=c;function p(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}s()}catch(e){s(e)}})},96487:()=>{},78335:()=>{},13765:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{DELETE:()=>l,GET:()=>c,PATCH:()=>d});var o=t(39187),a=t(7879),i=t(9801),n=t(97873),u=t.n(n),p=e([a,i]);[a,i]=p.then?(await p)():p,u().v2.config({cloud_name:process.env.CLOUDINARY_CLOUD_NAME,api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET}),(0,i.getApps)().length||(0,i.initializeApp)({credential:(0,i.cert)({projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n")})});let f=(0,a.getFirestore)();async function c(e,r){try{let{id:e}=await r.params;if(!e)return o.NextResponse.json({error:"Donation ID required"},{status:400});let t=f.collection("donated_food").doc(e),s=await t.get();if(!s.exists)return o.NextResponse.json({error:"Donation not found"},{status:404});return o.NextResponse.json({id:s.id,...s.data()})}catch{return o.NextResponse.json({error:"Server error"},{status:500})}}async function d(e,r){try{let{id:t}=await r.params;if(!t)return o.NextResponse.json({error:"Donation ID required"},{status:400});let s={},a=null;if((e.headers.get("content-type")||"").includes("multipart/form-data")){let r=await e.formData();s={foodName:r.get("title"),description:r.get("description"),location:r.get("location"),expiryDate:r.get("expiryDate"),pickupInstructions:r.get("pickupInstructions")};let t=r.get("foodImage");if(t&&"object"==typeof t&&"arrayBuffer"in t){let e=Buffer.from(await t.arrayBuffer());await new Promise((r,t)=>{u().v2.uploader.upload_stream({folder:"donated_food",resource_type:"image"},(e,s)=>{if(e)return t(e);s&&s.secure_url?(a=s.secure_url,r(s)):t(Error("No result from Cloudinary upload"))}).end(e)}),a&&(s.imageUrl=a)}}else s=await e.json();Object.keys(s).forEach(e=>void 0===s[e]?delete s[e]:void 0);let i=f.collection("donated_food").doc(t);return await i.update(s),o.NextResponse.json({success:!0,imageUrl:s.imageUrl})}catch{return o.NextResponse.json({error:"Server error"},{status:500})}}async function l(e,r){try{let{id:e}=await r.params;if(!e)return o.NextResponse.json({error:"Donation ID required"},{status:400});return await f.collection("donated_food").doc(e).delete(),o.NextResponse.json({success:!0})}catch{return o.NextResponse.json({error:"Server error"},{status:500})}}s()}catch(e){s(e)}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,71,873],()=>t(12916));module.exports=s})();